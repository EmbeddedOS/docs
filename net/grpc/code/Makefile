GRPC_ROOT_FOLDER=/home/larva/.local/
INCLUDE=${GRPC_ROOT_FOLDER}include
LIB=${GRPC_ROOT_FOLDER}lib

GRPC_CPP_PLUGIN_PATH=${GRPC_ROOT_FOLDER}bin/grpc_cpp_plugin

LDFLAGS=${LIB}/libabsl_flags_parse.a ${LIB}/libabsl_log_initialize.a ${LIB}/libgrpc++_reflection.a ${LIB}/libgrpc++.a ${LIB}/libprotobuf.a ${LIB}/libgrpc.a ${LIB}/libupb_json_lib.a ${LIB}/libupb_textformat_lib.a ${LIB}/libupb_lex_lib.a ${LIB}/libupb_reflection_lib.a ${LIB}/libupb_mini_descriptor_lib.a ${LIB}/libupb_wire_lib.a ${LIB}/libutf8_range_lib.a ${LIB}/libupb_message_lib.a ${LIB}/libupb_mini_table_lib.a ${LIB}/libupb_hash_lib.a ${LIB}/libupb_base_lib.a ${LIB}/libupb_mem_lib.a ${LIB}/libre2.a ${LIB}/libz.a ${LIB}/libcares.a ${LIB}/libgpr.a ${LIB}/libssl.a ${LIB}/libcrypto.a ${LIB}/libaddress_sorting.a -ldl -lm -lrt ${LIB}/libabsl_log_initialize.a ${LIB}/libabsl_log_internal_check_op.a ${LIB}/libabsl_die_if_null.a ${LIB}/libabsl_log_internal_conditions.a ${LIB}/libabsl_log_internal_message.a ${LIB}/libabsl_log_internal_nullguard.a ${LIB}/libabsl_examine_stack.a ${LIB}/libabsl_log_internal_format.a ${LIB}/libabsl_log_internal_structured_proto.a ${LIB}/libabsl_log_internal_proto.a ${LIB}/libabsl_log_internal_log_sink_set.a ${LIB}/libabsl_log_globals.a ${LIB}/libabsl_log_internal_globals.a ${LIB}/libabsl_log_sink.a ${LIB}/libabsl_log_entry.a ${LIB}/libabsl_vlog_config_internal.a ${LIB}/libabsl_log_internal_fnmatch.a ${LIB}/libabsl_random_distributions.a ${LIB}/libabsl_random_seed_sequences.a ${LIB}/libabsl_random_internal_pool_urbg.a ${LIB}/libabsl_random_internal_randen.a ${LIB}/libabsl_random_internal_randen_hwaes.a ${LIB}/libabsl_random_internal_randen_hwaes_impl.a ${LIB}/libabsl_random_internal_randen_slow.a ${LIB}/libabsl_random_internal_platform.a ${LIB}/libabsl_random_internal_seed_material.a ${LIB}/libabsl_random_seed_gen_exception.a ${LIB}/libabsl_statusor.a ${LIB}/libabsl_status.a ${LIB}/libabsl_leak_check.a ${LIB}/libabsl_strerror.a ${LIB}/libutf8_validity.a ${LIB}/libabsl_flags_usage.a ${LIB}/libabsl_flags_usage_internal.a ${LIB}/libabsl_flags_internal.a ${LIB}/libabsl_flags_marshalling.a ${LIB}/libabsl_flags_reflection.a ${LIB}/libabsl_flags_config.a ${LIB}/libabsl_raw_hash_set.a ${LIB}/libabsl_cord.a ${LIB}/libabsl_cordz_info.a ${LIB}/libabsl_cord_internal.a ${LIB}/libabsl_cordz_functions.a ${LIB}/libabsl_cordz_handle.a ${LIB}/libabsl_crc_cord_state.a ${LIB}/libabsl_crc32c.a ${LIB}/libabsl_str_format_internal.a ${LIB}/libabsl_crc_internal.a ${LIB}/libabsl_crc_cpu_detect.a ${LIB}/libabsl_hash.a ${LIB}/libabsl_city.a ${LIB}/libabsl_bad_variant_access.a ${LIB}/libabsl_low_level_hash.a ${LIB}/libabsl_hashtablez_sampler.a ${LIB}/libabsl_exponential_biased.a ${LIB}/libabsl_flags_private_handle_accessor.a ${LIB}/libabsl_flags_commandlineflag.a ${LIB}/libabsl_bad_optional_access.a ${LIB}/libabsl_flags_commandlineflag_internal.a ${LIB}/libabsl_flags_program_name.a ${LIB}/libabsl_synchronization.a ${LIB}/libabsl_graphcycles_internal.a ${LIB}/libabsl_kernel_timeout_internal.a ${LIB}/libabsl_time.a ${LIB}/libabsl_civil_time.a ${LIB}/libabsl_time_zone.a ${LIB}/libabsl_stacktrace.a ${LIB}/libabsl_symbolize.a ${LIB}/libabsl_strings.a ${LIB}/libabsl_strings_internal.a ${LIB}/libabsl_string_view.a ${LIB}/libabsl_int128.a ${LIB}/libabsl_throw_delegate.a ${LIB}/libabsl_malloc_internal.a ${LIB}/libabsl_debugging_internal.a ${LIB}/libabsl_demangle_internal.a ${LIB}/libabsl_demangle_rust.a ${LIB}/libabsl_decode_rust_punycode.a ${LIB}/libabsl_utf8_for_code_point.a ${LIB}/libabsl_tracing_internal.a ${LIB}/libabsl_base.a ${LIB}/libabsl_raw_logging_internal.a ${LIB}/libabsl_log_severity.a ${LIB}/libabsl_spinlock_wait.a -lrt

all:
	g++ server.cc sensor.pb.cc sensor.grpc.pb.cc -o server.o -I${INCLUDE} ${LDFLAGS}
	g++ client.cc sensor.pb.cc sensor.grpc.pb.cc -o client.o -I${INCLUDE} ${LDFLAGS}

proto:
	# Build message classes.
	protoc --cpp_out=. sensor.proto

	# Build rpc service classes.
	protoc --grpc_out=. sensor.proto --plugin=protoc-gen-grpc=$(GRPC_CPP_PLUGIN_PATH)
 
